<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1486px" preserveAspectRatio="none" style="width:2492px;height:1486px;" version="1.1" viewBox="0 0 2492 1486" width="2492px" zoomAndPan="magnify"><defs><filter height="300%" id="f1d57axh1ysm2b" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--class nsHTMLDocument--><rect fill="#FEFECE" filter="url(#f1d57axh1ysm2b)" height="73.6094" id="nsHTMLDocument" style="stroke: #A80036; stroke-width: 1.5;" width="246" x="899" y="501"/><ellipse cx="962.25" cy="517" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M965.2188,522.6406 Q964.6406,522.9375 964,523.0859 Q963.3594,523.2344 962.6563,523.2344 Q960.1563,523.2344 958.8359,521.5859 Q957.5156,519.9375 957.5156,516.8125 Q957.5156,513.6875 958.8359,512.0313 Q960.1563,510.375 962.6563,510.375 Q963.3594,510.375 964.0078,510.5313 Q964.6563,510.6875 965.2188,510.9844 L965.2188,513.7031 Q964.5938,513.125 964,512.8516 Q963.4063,512.5781 962.7813,512.5781 Q961.4375,512.5781 960.75,513.6484 Q960.0625,514.7188 960.0625,516.8125 Q960.0625,518.9063 960.75,519.9766 Q961.4375,521.0469 962.7813,521.0469 Q963.4063,521.0469 964,520.7734 Q964.5938,520.5 965.2188,519.9219 L965.2188,522.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="111" x="982.75" y="521.1543">nsHTMLDocument</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="900" x2="1144" y1="533" y2="533"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="149" x="905" y="547.2104">void SetCompatibilityMode</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="900" x2="1144" y1="553.8047" y2="553.8047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="234" x="905" y="568.0151">nsHtml5Parser : mParser(@Document.h)</text><!--class nsHtml5Parser--><rect fill="#FEFECE" filter="url(#f1d57axh1ysm2b)" height="73.6094" id="nsHtml5Parser" style="stroke: #A80036; stroke-width: 1.5;" width="310" x="837" y="636"/><ellipse cx="941.75" cy="652" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M944.7188,657.6406 Q944.1406,657.9375 943.5,658.0859 Q942.8594,658.2344 942.1563,658.2344 Q939.6563,658.2344 938.3359,656.5859 Q937.0156,654.9375 937.0156,651.8125 Q937.0156,648.6875 938.3359,647.0313 Q939.6563,645.375 942.1563,645.375 Q942.8594,645.375 943.5078,645.5313 Q944.1563,645.6875 944.7188,645.9844 L944.7188,648.7031 Q944.0938,648.125 943.5,647.8516 Q942.9063,647.5781 942.2813,647.5781 Q940.9375,647.5781 940.25,648.6484 Q939.5625,649.7188 939.5625,651.8125 Q939.5625,653.9063 940.25,654.9766 Q940.9375,656.0469 942.2813,656.0469 Q942.9063,656.0469 943.5,655.7734 Q944.0938,655.5 944.7188,654.9219 L944.7188,657.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="92" x="962.25" y="656.1543">nsHtml5Parser</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="838" x2="1146" y1="668" y2="668"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="298" x="843" y="682.2104">RefPtr&lt;nsHtml5StreamListener&gt; : mStreamListener</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="262" x="843" y="695.0151">RefPtr&lt;nsHtml5TreeOpExecutor&gt; : mExecutor</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="838" x2="1146" y1="701.6094" y2="701.6094"/><path d="M1180,525.5 L1180,550.6328 A0,0 0 0 0 1180,550.6328 L1288.1576,550.6328 L1082.8906,635.9298 L1296.1576,550.6328 L1466,550.6328 A0,0 0 0 0 1466,550.6328 L1466,535.5 L1456,525.5 L1180,525.5 A0,0 0 0 0 1180,525.5 " fill="#FBFB77" filter="url(#f1d57axh1ysm2b)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1456,525.5 L1456,535.5 L1466,535.5 L1456,525.5 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="265" x="1186" y="542.5669">document.write()から得られるデータを扱う</text><!--class nsHtml5StreamParser--><rect fill="#FEFECE" filter="url(#f1d57axh1ysm2b)" height="124.8281" id="nsHtml5StreamParser" style="stroke: #A80036; stroke-width: 1.5;" width="341" x="1138.5" y="771"/><ellipse cx="1236.25" cy="787" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1239.2188,792.6406 Q1238.6406,792.9375 1238,793.0859 Q1237.3594,793.2344 1236.6563,793.2344 Q1234.1563,793.2344 1232.8359,791.5859 Q1231.5156,789.9375 1231.5156,786.8125 Q1231.5156,783.6875 1232.8359,782.0313 Q1234.1563,780.375 1236.6563,780.375 Q1237.3594,780.375 1238.0078,780.5313 Q1238.6563,780.6875 1239.2188,780.9844 L1239.2188,783.7031 Q1238.5938,783.125 1238,782.8516 Q1237.4063,782.5781 1236.7813,782.5781 Q1235.4375,782.5781 1234.75,783.6484 Q1234.0625,784.7188 1234.0625,786.8125 Q1234.0625,788.9063 1234.75,789.9766 Q1235.4375,791.0469 1236.7813,791.0469 Q1237.4063,791.0469 1238,790.7734 Q1238.5938,790.5 1239.2188,789.9219 L1239.2188,792.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="137" x="1256.75" y="791.1543">nsHtml5StreamParser</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1139.5" x2="1478.5" y1="803" y2="803"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="283" x="1144.5" y="817.2104">nsCOMPtr&lt;nsISerialEventTarget&gt; : mEventTarget</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="329" x="1144.5" y="830.0151">mozilla::UniquePtr&lt;mozilla::Decoder&gt; : mUnicodeDecoder</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="248" x="1144.5" y="842.8198">nsHtml5OwningUTF16Buffer* : mFirstBuffer</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="247" x="1144.5" y="855.6245">nsHtml5OwningUTF16Buffer* : mLastBuffer</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="275" x="1144.5" y="868.4292">nsAutoPtr&lt;nsHtml5TreeBuilder&gt; : mTreeBuilder</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="251" x="1144.5" y="881.2339">nsAutoPtr&lt;nsHtml5Tokenizer&gt; : mTokenizer</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1139.5" x2="1478.5" y1="887.8281" y2="887.8281"/><path d="M1536.5,660.5 L1536.5,685.6328 A0,0 0 0 0 1536.5,685.6328 L1619.2423,685.6328 L1442.022,770.8899 L1627.2423,685.6328 L1763.5,685.6328 A0,0 0 0 0 1763.5,685.6328 L1763.5,670.5 L1753.5,660.5 L1536.5,660.5 A0,0 0 0 0 1536.5,660.5 " fill="#FBFB77" filter="url(#f1d57axh1ysm2b)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1753.5,660.5 L1753.5,670.5 L1763.5,670.5 L1753.5,660.5 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="206" x="1542.5" y="677.5669">networkから得られるデータを扱う</text><!--class nsHtml5Tokenizer--><rect fill="#FEFECE" filter="url(#f1d57axh1ysm2b)" height="99.2188" id="nsHtml5Tokenizer" style="stroke: #A80036; stroke-width: 1.5;" width="284" x="6" y="989"/><ellipse cx="88.75" cy="1005" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M91.7188,1010.6406 Q91.1406,1010.9375 90.5,1011.0859 Q89.8594,1011.2344 89.1563,1011.2344 Q86.6563,1011.2344 85.3359,1009.5859 Q84.0156,1007.9375 84.0156,1004.8125 Q84.0156,1001.6875 85.3359,1000.0313 Q86.6563,998.375 89.1563,998.375 Q89.8594,998.375 90.5078,998.5313 Q91.1563,998.6875 91.7188,998.9844 L91.7188,1001.7031 Q91.0938,1001.125 90.5,1000.8516 Q89.9063,1000.5781 89.2813,1000.5781 Q87.9375,1000.5781 87.25,1001.6484 Q86.5625,1002.7188 86.5625,1004.8125 Q86.5625,1006.9063 87.25,1007.9766 Q87.9375,1009.0469 89.2813,1009.0469 Q89.9063,1009.0469 90.5,1008.7734 Q91.0938,1008.5 91.7188,1007.9219 L91.7188,1010.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="110" x="109.25" y="1009.1543">nsHtml5Tokenizer</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="7" x2="289" y1="1021" y2="1021"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="206" x="26" y="1035.2104">nsHtml5TreeBuilder* : tokenHandler</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="243" x="26" y="1048.0151">//== nsHtml5StreamParser#mTreeBuilder</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="258" x="26" y="1060.8198">tokenizer作成時にtokenHandlerは引数で渡される</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="14" y="1068.3164"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="141" x="26" y="1073.6245">ElementName : tagname</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="7" x2="289" y1="1080.2188" y2="1080.2188"/><!--class nsHtml5TreeBuilder--><rect fill="#FEFECE" filter="url(#f1d57axh1ysm2b)" height="163.2422" id="nsHtml5TreeBuilder" style="stroke: #A80036; stroke-width: 1.5;" width="597" x="1010.5" y="957"/><ellipse cx="1243.75" cy="973" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1246.7188,978.6406 Q1246.1406,978.9375 1245.5,979.0859 Q1244.8594,979.2344 1244.1563,979.2344 Q1241.6563,979.2344 1240.3359,977.5859 Q1239.0156,975.9375 1239.0156,972.8125 Q1239.0156,969.6875 1240.3359,968.0313 Q1241.6563,966.375 1244.1563,966.375 Q1244.8594,966.375 1245.5078,966.5313 Q1246.1563,966.6875 1246.7188,966.9844 L1246.7188,969.7031 Q1246.0938,969.125 1245.5,968.8516 Q1244.9063,968.5781 1244.2813,968.5781 Q1242.9375,968.5781 1242.25,969.6484 Q1241.5625,970.7188 1241.5625,972.8125 Q1241.5625,974.9063 1242.25,975.9766 Q1242.9375,977.0469 1244.2813,977.0469 Q1244.9063,977.0469 1245.5,976.7734 Q1246.0938,976.5 1246.7188,975.9219 L1246.7188,978.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="122" x="1264.25" y="977.1543">nsHtml5TreeBuilder</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1011.5" x2="1606.5" y1="989" y2="989"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="190" x="1030.5" y="1003.2104">mBuilder : nsHtml5OplessBuilder</text><polygon fill="none" points="1021.5,1008.707,1025.5,1012.707,1021.5,1016.707,1017.5,1012.707" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="170" x="1030.5" y="1016.0151">nsHtml5Tokenizer* : tokenizer</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="186" x="1030.5" y="1028.8198">treeBuilder生成時はtokenzerはnull</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="357" x="1030.5" y="1041.6245">その後startTokenizationするときに引数としてtokenizerを渡している</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="263" x="1030.5" y="1054.4292">nsStreamParserがtokenizerをtreeBuilderを作る</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1018.5" y="1061.9258"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="277" x="1030.5" y="1067.2339">autoJArray&lt;nsHtml5StackNode*, int32_t&gt; : stack</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1018.5" y="1074.7305"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="274" x="1030.5" y="1080.0386">nsTArray&lt;nsHtml5TreeOperation&gt; : mOpQueue</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1011.5" x2="1606.5" y1="1086.6328" y2="1086.6328"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="182" x="1016.5" y="1100.8433">tokenizerを作る(arg: treeBuilder)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="585" x="1016.5" y="1113.6479">OnRequest時にstreamParser#mTokenize-&gt;startでtokenizerが tokenHandler-&gt;startTokenization(this)する</text><!--class nsHtml5OplessBuilder--><rect fill="#FEFECE" filter="url(#f1d57axh1ysm2b)" height="48" id="nsHtml5OplessBuilder" style="stroke: #A80036; stroke-width: 1.5;" width="168" x="1907" y="1014.5"/><ellipse cx="1922" cy="1030.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1924.9688,1036.1406 Q1924.3906,1036.4375 1923.75,1036.5859 Q1923.1094,1036.7344 1922.4063,1036.7344 Q1919.9063,1036.7344 1918.5859,1035.0859 Q1917.2656,1033.4375 1917.2656,1030.3125 Q1917.2656,1027.1875 1918.5859,1025.5313 Q1919.9063,1023.875 1922.4063,1023.875 Q1923.1094,1023.875 1923.7578,1024.0313 Q1924.4063,1024.1875 1924.9688,1024.4844 L1924.9688,1027.2031 Q1924.3438,1026.625 1923.75,1026.3516 Q1923.1563,1026.0781 1922.5313,1026.0781 Q1921.1875,1026.0781 1920.5,1027.1484 Q1919.8125,1028.2188 1919.8125,1030.3125 Q1919.8125,1032.4063 1920.5,1033.4766 Q1921.1875,1034.5469 1922.5313,1034.5469 Q1923.1563,1034.5469 1923.75,1034.2734 Q1924.3438,1034 1924.9688,1033.4219 L1924.9688,1036.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="136" x="1936" y="1034.6543">nsHtml5OplessBuilder</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1908" x2="2074" y1="1046.5" y2="1046.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1908" x2="2074" y1="1054.5" y2="1054.5"/><!--class nsHtml5DocumentBuilder--><rect fill="#FEFECE" filter="url(#f1d57axh1ysm2b)" height="73.6094" id="nsHtml5DocumentBuilder" style="stroke: #A80036; stroke-width: 1.5;" width="302" x="1840" y="275"/><ellipse cx="1907.75" cy="291" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1910.7188,296.6406 Q1910.1406,296.9375 1909.5,297.0859 Q1908.8594,297.2344 1908.1563,297.2344 Q1905.6563,297.2344 1904.3359,295.5859 Q1903.0156,293.9375 1903.0156,290.8125 Q1903.0156,287.6875 1904.3359,286.0313 Q1905.6563,284.375 1908.1563,284.375 Q1908.8594,284.375 1909.5078,284.5313 Q1910.1563,284.6875 1910.7188,284.9844 L1910.7188,287.7031 Q1910.0938,287.125 1909.5,286.8516 Q1908.9063,286.5781 1908.2813,286.5781 Q1906.9375,286.5781 1906.25,287.6484 Q1905.5625,288.7188 1905.5625,290.8125 Q1905.5625,292.9063 1906.25,293.9766 Q1906.9375,295.0469 1908.2813,295.0469 Q1908.9063,295.0469 1909.5,294.7734 Q1910.0938,294.5 1910.7188,293.9219 L1910.7188,296.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="158" x="1928.25" y="295.1543">nsHtml5DocumentBuilder</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1841" x2="2141" y1="307" y2="307"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1841" x2="2141" y1="315" y2="315"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="290" x="1846" y="329.2104">void SetDocumentMode(nsHtml5DocumentMode m)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="289" x="1846" y="342.0151">Document* GetDocument() { return mDocument; }</text><!--class nsContentSink--><rect fill="#FEFECE" filter="url(#f1d57axh1ysm2b)" height="60.8047" id="nsContentSink" style="stroke: #A80036; stroke-width: 1.5;" width="237" x="1867.5" y="33.5"/><ellipse cx="1936.25" cy="49.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1939.2188,55.1406 Q1938.6406,55.4375 1938,55.5859 Q1937.3594,55.7344 1936.6563,55.7344 Q1934.1563,55.7344 1932.8359,54.0859 Q1931.5156,52.4375 1931.5156,49.3125 Q1931.5156,46.1875 1932.8359,44.5313 Q1934.1563,42.875 1936.6563,42.875 Q1937.3594,42.875 1938.0078,43.0313 Q1938.6563,43.1875 1939.2188,43.4844 L1939.2188,46.2031 Q1938.5938,45.625 1938,45.3516 Q1937.4063,45.0781 1936.7813,45.0781 Q1935.4375,45.0781 1934.75,46.1484 Q1934.0625,47.2188 1934.0625,49.3125 Q1934.0625,51.4063 1934.75,52.4766 Q1935.4375,53.5469 1936.7813,53.5469 Q1937.4063,53.5469 1938,53.2734 Q1938.5938,53 1939.2188,52.4219 L1939.2188,55.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="91" x="1956.75" y="53.6543">nsContentSink</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1868.5" x2="2103.5" y1="65.5" y2="65.5"/><polygon fill="none" points="1878.5,72.4023,1882.5,76.4023,1878.5,80.4023,1874.5,76.4023" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="211" x="1887.5" y="79.7104">mDocument : nsCOMPtr&lt;Document&gt;</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1868.5" x2="2103.5" y1="86.3047" y2="86.3047"/><path d="M2140,51.5 L2140,60 L2104.6523,64 L2140,68 L2140,76.6328 A0,0 0 0 0 2140,76.6328 L2480,76.6328 A0,0 0 0 0 2480,76.6328 L2480,61.5 L2470,51.5 L2140,51.5 A0,0 0 0 0 2140,51.5 " fill="#FBFB77" filter="url(#f1d57axh1ysm2b)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M2470,51.5 L2470,61.5 L2480,61.5 L2470,51.5 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="319" x="2146" y="68.5669">parserから文字列を受け取って溜めてDOMを作る場所</text><!--class Document--><rect fill="#FEFECE" filter="url(#f1d57axh1ysm2b)" height="48" id="Document" style="stroke: #A80036; stroke-width: 1.5;" width="96" x="1146" y="197"/><ellipse cx="1161" cy="213" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1156.9219,208.7656 L1156.9219,206.6094 L1164.3125,206.6094 L1164.3125,208.7656 L1161.8438,208.7656 L1161.8438,216.8438 L1164.3125,216.8438 L1164.3125,219 L1156.9219,219 L1156.9219,216.8438 L1159.3906,216.8438 L1159.3906,208.7656 L1156.9219,208.7656 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="64" x="1175" y="217.1543">Document</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1147" x2="1241" y1="229" y2="229"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1147" x2="1241" y1="237" y2="237"/><path d="M631,201 L631,241.2656 A0,0 0 0 0 631,241.2656 L1111,241.2656 A0,0 0 0 0 1111,241.2656 L1111,225 L1145.7158,221 L1111,217 L1111,211 L1101,201 L631,201 A0,0 0 0 0 631,201 " fill="#FBFB77" filter="url(#f1d57axh1ysm2b)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1101,201 L1101,211 L1111,211 L1101,201 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="637" y="218.0669">Document interface.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="455" x="641" y="233.1997">This is implemented by all document objects in Gecko(元nsIDocument).</text><!--class nsDocument--><rect fill="#FEFECE" filter="url(#f1d57axh1ysm2b)" height="60.8047" id="nsDocument" style="stroke: #A80036; stroke-width: 1.5;" width="162" x="1021" y="379"/><ellipse cx="1058.95" cy="395" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1061.9188,400.6406 Q1061.3406,400.9375 1060.7,401.0859 Q1060.0594,401.2344 1059.3563,401.2344 Q1056.8563,401.2344 1055.5359,399.5859 Q1054.2156,397.9375 1054.2156,394.8125 Q1054.2156,391.6875 1055.5359,390.0313 Q1056.8563,388.375 1059.3563,388.375 Q1060.0594,388.375 1060.7078,388.5313 Q1061.3563,388.6875 1061.9188,388.9844 L1061.9188,391.7031 Q1061.2938,391.125 1060.7,390.8516 Q1060.1063,390.5781 1059.4813,390.5781 Q1058.1375,390.5781 1057.45,391.6484 Q1056.7625,392.7188 1056.7625,394.8125 Q1056.7625,396.9063 1057.45,397.9766 Q1058.1375,399.0469 1059.4813,399.0469 Q1060.1063,399.0469 1060.7,398.7734 Q1061.2938,398.5 1061.9188,397.9219 L1061.9188,400.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="79" x="1078.05" y="399.1543">nsDocument</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1022" x2="1182" y1="411" y2="411"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="150" x="1027" y="425.2104">nsIPresShell* mPresShell;</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1022" x2="1182" y1="431.8047" y2="431.8047"/><!--class nsINode--><rect fill="#FEFECE" filter="url(#f1d57axh1ysm2b)" height="112.0234" id="nsINode" style="stroke: #A80036; stroke-width: 1.5;" width="373" x="1015.5" y="8"/><ellipse cx="1172.25" cy="24" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1168.1719,19.7656 L1168.1719,17.6094 L1175.5625,17.6094 L1175.5625,19.7656 L1173.0938,19.7656 L1173.0938,27.8438 L1175.5625,27.8438 L1175.5625,30 L1168.1719,30 L1168.1719,27.8438 L1170.6406,27.8438 L1170.6406,19.7656 L1168.1719,19.7656 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="51" x="1192.75" y="28.1543">nsINode</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1016.5" x2="1387.5" y1="40" y2="40"/><polygon fill="none" points="1026.5,46.9023,1030.5,50.9023,1026.5,54.9023,1022.5,50.9023" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="213" x="1035.5" y="54.2104">nsINode* MOZ_OWNING_REF mParent</text><polygon fill="none" points="1026.5,59.707,1030.5,63.707,1026.5,67.707,1022.5,63.707" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="203" x="1035.5" y="67.0151">nsCOMPtr&lt;nsIContent&gt; mFirstChild</text><polygon fill="none" points="1026.5,72.5117,1030.5,76.5117,1026.5,80.5117,1022.5,76.5117" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="213" x="1035.5" y="79.8198">nsCOMPtr&lt;nsIContent&gt; mNextSibling</text><polygon fill="none" points="1026.5,85.3164,1030.5,89.3164,1026.5,93.3164,1022.5,89.3164" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="347" x="1035.5" y="92.6245">nsIContent* MOZ_NON_OWNING_REF mPreviousOrLastSibling</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1016.5" x2="1387.5" y1="99.2188" y2="99.2188"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="313" x="1021.5" y="113.4292">nsresult AppendChildTo(nsIContent* aKid, bool aNotify)</text><path d="M477.5,36.5 L477.5,91.8984 A0,0 0 0 0 477.5,91.8984 L980.5,91.8984 A0,0 0 0 0 980.5,91.8984 L980.5,68 L1015.3145,64 L980.5,60 L980.5,46.5 L970.5,36.5 L477.5,36.5 A0,0 0 0 0 477.5,36.5 " fill="#FBFB77" filter="url(#f1d57axh1ysm2b)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M970.5,36.5 L970.5,46.5 L980.5,46.5 L970.5,36.5 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="482" x="483.5" y="53.5669">An internal interface that abstracts some DOMNode-related parts that both</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="459" x="487.5" y="68.6997">nsIContent and Document share.  An instance of this interface has a list</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="332" x="487.5" y="83.8325">of nsIContent children and provides access to them.</text><!--class nsHtml5Available--><rect fill="#FEFECE" filter="url(#f1d57axh1ysm2b)" height="60.8047" id="nsHtml5Available" style="stroke: #A80036; stroke-width: 1.5;" width="258" x="845" y="803"/><ellipse cx="916.75" cy="819" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M919.7188,824.6406 Q919.1406,824.9375 918.5,825.0859 Q917.8594,825.2344 917.1563,825.2344 Q914.6563,825.2344 913.3359,823.5859 Q912.0156,821.9375 912.0156,818.8125 Q912.0156,815.6875 913.3359,814.0313 Q914.6563,812.375 917.1563,812.375 Q917.8594,812.375 918.5078,812.5313 Q919.1563,812.6875 919.7188,812.9844 L919.7188,815.7031 Q919.0938,815.125 918.5,814.8516 Q917.9063,814.5781 917.2813,814.5781 Q915.9375,814.5781 915.25,815.6484 Q914.5625,816.7188 914.5625,818.8125 Q914.5625,820.9063 915.25,821.9766 Q915.9375,823.0469 917.2813,823.0469 Q917.9063,823.0469 918.5,822.7734 Q919.0938,822.5 919.7188,821.9219 L919.7188,824.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="106" x="937.25" y="823.1543">nsHtml5Available</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="846" x2="1102" y1="835" y2="835"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="246" x="851" y="849.2104">nsHtml5StreamParserPtr : mStreamParser</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="846" x2="1102" y1="855.8047" y2="855.8047"/><!--class nsHtml5StreamListener--><rect fill="#FEFECE" filter="url(#f1d57axh1ysm2b)" height="60.8047" id="nsHtml5StreamListener" style="stroke: #A80036; stroke-width: 1.5;" width="218" x="455" y="803"/><ellipse cx="488" cy="819" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M490.9688,824.6406 Q490.3906,824.9375 489.75,825.0859 Q489.1094,825.2344 488.4063,825.2344 Q485.9063,825.2344 484.5859,823.5859 Q483.2656,821.9375 483.2656,818.8125 Q483.2656,815.6875 484.5859,814.0313 Q485.9063,812.375 488.4063,812.375 Q489.1094,812.375 489.7578,812.5313 Q490.4063,812.6875 490.9688,812.9844 L490.9688,815.7031 Q490.3438,815.125 489.75,814.8516 Q489.1563,814.5781 488.5313,814.5781 Q487.1875,814.5781 486.5,815.6484 Q485.8125,816.7188 485.8125,818.8125 Q485.8125,820.9063 486.5,821.9766 Q487.1875,823.0469 488.5313,823.0469 Q489.1563,823.0469 489.75,822.7734 Q490.3438,822.5 490.9688,821.9219 L490.9688,824.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="146" x="506" y="823.1543">nsHtml5StreamListener</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="456" x2="672" y1="835" y2="835"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="206" x="461" y="849.2104">nsHtml5StreamParser* : mDelegate</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="456" x2="672" y1="855.8047" y2="855.8047"/><!--class tokenizerTreeBuilderPair--><rect fill="#FEFECE" filter="url(#f1d57axh1ysm2b)" height="48" id="tokenizerTreeBuilderPair" style="stroke: #A80036; stroke-width: 1.5;" width="184" x="1515" y="809.5"/><ellipse cx="1530" cy="825.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1532.9688,831.1406 Q1532.3906,831.4375 1531.75,831.5859 Q1531.1094,831.7344 1530.4063,831.7344 Q1527.9063,831.7344 1526.5859,830.0859 Q1525.2656,828.4375 1525.2656,825.3125 Q1525.2656,822.1875 1526.5859,820.5313 Q1527.9063,818.875 1530.4063,818.875 Q1531.1094,818.875 1531.7578,819.0313 Q1532.4063,819.1875 1532.9688,819.4844 L1532.9688,822.2031 Q1532.3438,821.625 1531.75,821.3516 Q1531.1563,821.0781 1530.5313,821.0781 Q1529.1875,821.0781 1528.5,822.1484 Q1527.8125,823.2188 1527.8125,825.3125 Q1527.8125,827.4063 1528.5,828.4766 Q1529.1875,829.5469 1530.5313,829.5469 Q1531.1563,829.5469 1531.75,829.2734 Q1532.3438,829 1532.9688,828.4219 L1532.9688,831.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="152" x="1544" y="829.6543">tokenizerTreeBuilderPair</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1516" x2="1698" y1="841.5" y2="841.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1516" x2="1698" y1="849.5" y2="849.5"/><path d="M708.5,821 L708.5,846.1328 L809.5,846.1328 L809.5,831 L799.5,821 L708.5,821 " fill="#FBFB77" filter="url(#f1d57axh1ysm2b)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M799.5,821 L799.5,831 L809.5,831 L799.5,821 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="80" x="714.5" y="838.0669">parsing data</text><!--class nsHtml5TreeOpExecutor--><rect fill="#FEFECE" filter="url(#f1d57axh1ysm2b)" height="73.6094" id="nsHtml5TreeOpExecutor" style="stroke: #A80036; stroke-width: 1.5;" width="248" x="1253" y="636"/><ellipse cx="1297.25" cy="652" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1300.2188,657.6406 Q1299.6406,657.9375 1299,658.0859 Q1298.3594,658.2344 1297.6563,658.2344 Q1295.1563,658.2344 1293.8359,656.5859 Q1292.5156,654.9375 1292.5156,651.8125 Q1292.5156,648.6875 1293.8359,647.0313 Q1295.1563,645.375 1297.6563,645.375 Q1298.3594,645.375 1299.0078,645.5313 Q1299.6563,645.6875 1300.2188,645.9844 L1300.2188,648.7031 Q1299.5938,648.125 1299,647.8516 Q1298.4063,647.5781 1297.7813,647.5781 Q1296.4375,647.5781 1295.75,648.6484 Q1295.0625,649.7188 1295.0625,651.8125 Q1295.0625,653.9063 1295.75,654.9766 Q1296.4375,656.0469 1297.7813,656.0469 Q1298.4063,656.0469 1299,655.7734 Q1299.5938,655.5 1300.2188,654.9219 L1300.2188,657.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="151" x="1317.75" y="656.1543">nsHtml5TreeOpExecutor</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1254" x2="1500" y1="668" y2="668"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="194" x="1259" y="682.2104">RefPtr&lt;nsParserBase&gt; : mParser</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="236" x="1259" y="695.0151">nsHtml5StreamParser* : mStreamParser</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1254" x2="1500" y1="701.6094" y2="701.6094"/><!--class nsHtml5StackNode--><rect fill="#FEFECE" filter="url(#f1d57axh1ysm2b)" height="60.8047" id="nsHtml5StackNode" style="stroke: #A80036; stroke-width: 1.5;" width="172" x="1190" y="1150"/><ellipse cx="1214.45" cy="1166" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1217.4188,1171.6406 Q1216.8406,1171.9375 1216.2,1172.0859 Q1215.5594,1172.2344 1214.8563,1172.2344 Q1212.3563,1172.2344 1211.0359,1170.5859 Q1209.7156,1168.9375 1209.7156,1165.8125 Q1209.7156,1162.6875 1211.0359,1161.0313 Q1212.3563,1159.375 1214.8563,1159.375 Q1215.5594,1159.375 1216.2078,1159.5313 Q1216.8563,1159.6875 1217.4188,1159.9844 L1217.4188,1162.7031 Q1216.7938,1162.125 1216.2,1161.8516 Q1215.6063,1161.5781 1214.9813,1161.5781 Q1213.6375,1161.5781 1212.95,1162.6484 Q1212.2625,1163.7188 1212.2625,1165.8125 Q1212.2625,1167.9063 1212.95,1168.9766 Q1213.6375,1170.0469 1214.9813,1170.0469 Q1215.6063,1170.0469 1216.2,1169.7734 Q1216.7938,1169.5 1217.4188,1168.9219 L1217.4188,1171.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="119" x="1230.55" y="1170.1543">nsHtml5StackNode</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1191" x2="1361" y1="1182" y2="1182"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1198" y="1190.9023"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="146" x="1210" y="1196.2104">nsIContentHandle* : node</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1191" x2="1361" y1="1202.8047" y2="1202.8047"/><!--class nsIContentHandle--><rect fill="#FEFECE" filter="url(#f1d57axh1ysm2b)" height="48" id="nsIContentHandle" style="stroke: #A80036; stroke-width: 1.5;" width="144" x="1382" y="1427"/><ellipse cx="1397" cy="1443" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1399.9688,1448.6406 Q1399.3906,1448.9375 1398.75,1449.0859 Q1398.1094,1449.2344 1397.4063,1449.2344 Q1394.9063,1449.2344 1393.5859,1447.5859 Q1392.2656,1445.9375 1392.2656,1442.8125 Q1392.2656,1439.6875 1393.5859,1438.0313 Q1394.9063,1436.375 1397.4063,1436.375 Q1398.1094,1436.375 1398.7578,1436.5313 Q1399.4063,1436.6875 1399.9688,1436.9844 L1399.9688,1439.7031 Q1399.3438,1439.125 1398.75,1438.8516 Q1398.1563,1438.5781 1397.5313,1438.5781 Q1396.1875,1438.5781 1395.5,1439.6484 Q1394.8125,1440.7188 1394.8125,1442.8125 Q1394.8125,1444.9063 1395.5,1445.9766 Q1396.1875,1447.0469 1397.5313,1447.0469 Q1398.1563,1447.0469 1398.75,1446.7734 Q1399.3438,1446.5 1399.9688,1445.9219 L1399.9688,1448.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="112" x="1411" y="1447.1543">nsIContentHandle</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1383" x2="1525" y1="1459" y2="1459"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1383" x2="1525" y1="1467" y2="1467"/><!--class nsIContent--><rect fill="#FEFECE" filter="url(#f1d57axh1ysm2b)" height="48" id="nsIContent" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="1784" y="1279.5"/><ellipse cx="1799" cy="1295.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1801.9688,1301.1406 Q1801.3906,1301.4375 1800.75,1301.5859 Q1800.1094,1301.7344 1799.4063,1301.7344 Q1796.9063,1301.7344 1795.5859,1300.0859 Q1794.2656,1298.4375 1794.2656,1295.3125 Q1794.2656,1292.1875 1795.5859,1290.5313 Q1796.9063,1288.875 1799.4063,1288.875 Q1800.1094,1288.875 1800.7578,1289.0313 Q1801.4063,1289.1875 1801.9688,1289.4844 L1801.9688,1292.2031 Q1801.3438,1291.625 1800.75,1291.3516 Q1800.1563,1291.0781 1799.5313,1291.0781 Q1798.1875,1291.0781 1797.5,1292.1484 Q1796.8125,1293.2188 1796.8125,1295.3125 Q1796.8125,1297.4063 1797.5,1298.4766 Q1798.1875,1299.5469 1799.5313,1299.5469 Q1800.1563,1299.5469 1800.75,1299.2734 Q1801.3438,1299 1801.9688,1298.4219 L1801.9688,1301.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="68" x="1813" y="1299.6543">nsIContent</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1785" x2="1883" y1="1311.5" y2="1311.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1785" x2="1883" y1="1319.5" y2="1319.5"/><path d="M1313.5,1283.5 L1313.5,1323.7656 A0,0 0 0 0 1313.5,1323.7656 L1748.5,1323.7656 A0,0 0 0 0 1748.5,1323.7656 L1748.5,1307.5 L1783.7343,1303.5 L1748.5,1299.5 L1748.5,1293.5 L1738.5,1283.5 L1313.5,1283.5 A0,0 0 0 0 1313.5,1283.5 " fill="#FBFB77" filter="url(#f1d57axh1ysm2b)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1738.5,1283.5 L1738.5,1293.5 L1748.5,1293.5 L1738.5,1283.5 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="410" x="1319.5" y="1300.5669">A node of content in a document's content model. This interface</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="1323.5" y="1315.6997">is supported by all content objects.</text><!--class HTMLSharedElement--><rect fill="#FEFECE" filter="url(#f1d57axh1ysm2b)" height="48" id="HTMLSharedElement" style="stroke: #A80036; stroke-width: 1.5;" width="160" x="1754" y="1427"/><ellipse cx="1769" cy="1443" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1771.9688,1448.6406 Q1771.3906,1448.9375 1770.75,1449.0859 Q1770.1094,1449.2344 1769.4063,1449.2344 Q1766.9063,1449.2344 1765.5859,1447.5859 Q1764.2656,1445.9375 1764.2656,1442.8125 Q1764.2656,1439.6875 1765.5859,1438.0313 Q1766.9063,1436.375 1769.4063,1436.375 Q1770.1094,1436.375 1770.7578,1436.5313 Q1771.4063,1436.6875 1771.9688,1436.9844 L1771.9688,1439.7031 Q1771.3438,1439.125 1770.75,1438.8516 Q1770.1563,1438.5781 1769.5313,1438.5781 Q1768.1875,1438.5781 1767.5,1439.6484 Q1766.8125,1440.7188 1766.8125,1442.8125 Q1766.8125,1444.9063 1767.5,1445.9766 Q1768.1875,1447.0469 1769.5313,1447.0469 Q1770.1563,1447.0469 1770.75,1446.7734 Q1771.3438,1446.5 1771.9688,1445.9219 L1771.9688,1448.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="128" x="1783" y="1447.1543">HTMLSharedElement</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1755" x2="1913" y1="1459" y2="1459"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1755" x2="1913" y1="1467" y2="1467"/><!--class nsHtml5TreeOperation--><rect fill="#FEFECE" filter="url(#f1d57axh1ysm2b)" height="124.8281" id="nsHtml5TreeOperation" style="stroke: #A80036; stroke-width: 1.5;" width="835" x="371.5" y="1241"/><ellipse cx="714.25" cy="1257" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M717.2188,1262.6406 Q716.6406,1262.9375 716,1263.0859 Q715.3594,1263.2344 714.6563,1263.2344 Q712.1563,1263.2344 710.8359,1261.5859 Q709.5156,1259.9375 709.5156,1256.8125 Q709.5156,1253.6875 710.8359,1252.0313 Q712.1563,1250.375 714.6563,1250.375 Q715.3594,1250.375 716.0078,1250.5313 Q716.6563,1250.6875 717.2188,1250.9844 L717.2188,1253.7031 Q716.5938,1253.125 716,1252.8516 Q715.4063,1252.5781 714.7813,1252.5781 Q713.4375,1252.5781 712.75,1253.6484 Q712.0625,1254.7188 712.0625,1256.8125 Q712.0625,1258.9063 712.75,1259.9766 Q713.4375,1261.0469 714.7813,1261.0469 Q715.4063,1261.0469 716,1260.7734 Q716.5938,1260.5 717.2188,1259.9219 L717.2188,1262.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="141" x="734.75" y="1261.1543">nsHtml5TreeOperation</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="372.5" x2="1205.5" y1="1273" y2="1273"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="379.5" y="1281.9023"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="196" x="391.5" y="1287.2104">union{nsIContent** node} : mOne</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="379.5" y="1294.707"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="91" x="391.5" y="1300.0151">union{} : mTwo</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="379.5" y="1307.5117"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="190" x="391.5" y="1312.8198">eHtml5TreeOperation : mOpCode</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="372.5" x2="1205.5" y1="1319.4141" y2="1319.4141"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="52" x="377.5" y="1333.6245">void Init()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="598" x="377.5" y="1346.4292">// args: (eHtml5TreeOperation aOpCode, char16_t* aBuffer, int32_t aLength, nsIContentHandle* aParent)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="823" x="377.5" y="1359.2339">// 呼び出し例: treeOp-&gt;Init(eTreeOpAppendText, bufferCopy.release(), aLength, deepTreeSurrogateParent ? deepTreeSurrogateParent : aParent);</text><path d="M325,1026 L325,1051.1328 A0,0 0 0 0 325,1051.1328 L652.7043,1051.1328 L756.1539,1240.8797 L660.7043,1051.1328 L975,1051.1328 A0,0 0 0 0 975,1051.1328 L975,1036 L965,1026 L325,1026 A0,0 0 0 0 325,1026 " fill="#FBFB77" filter="url(#f1d57axh1ysm2b)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M965,1026 L965,1036 L975,1036 L965,1026 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="629" x="331" y="1043.0669">portable_parser_coreのtree_operationという出力をactions_performed_on_the_Gecko_DOMに変える</text><!--class nsIHTMLDocument--><rect fill="#FEFECE" filter="url(#f1d57axh1ysm2b)" height="48" id="nsIHTMLDocument" style="stroke: #A80036; stroke-width: 1.5;" width="146" x="1257" y="385.5"/><ellipse cx="1272" cy="401.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1274.9688,407.1406 Q1274.3906,407.4375 1273.75,407.5859 Q1273.1094,407.7344 1272.4063,407.7344 Q1269.9063,407.7344 1268.5859,406.0859 Q1267.2656,404.4375 1267.2656,401.3125 Q1267.2656,398.1875 1268.5859,396.5313 Q1269.9063,394.875 1272.4063,394.875 Q1273.1094,394.875 1273.7578,395.0313 Q1274.4063,395.1875 1274.9688,395.4844 L1274.9688,398.2031 Q1274.3438,397.625 1273.75,397.3516 Q1273.1563,397.0781 1272.5313,397.0781 Q1271.1875,397.0781 1270.5,398.1484 Q1269.8125,399.2188 1269.8125,401.3125 Q1269.8125,403.4063 1270.5,404.4766 Q1271.1875,405.5469 1272.5313,405.5469 Q1273.1563,405.5469 1273.75,405.2734 Q1274.3438,405 1274.9688,404.4219 L1274.9688,407.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="114" x="1286" y="405.6543">nsIHTMLDocument</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1258" x2="1402" y1="417.5" y2="417.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1258" x2="1402" y1="425.5" y2="425.5"/><!--class nsISupports--><rect fill="#FEFECE" filter="url(#f1d57axh1ysm2b)" height="48" id="nsISupports" style="stroke: #A80036; stroke-width: 1.5;" width="107" x="1277.5" y="197"/><ellipse cx="1292.5" cy="213" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1295.4688,218.6406 Q1294.8906,218.9375 1294.25,219.0859 Q1293.6094,219.2344 1292.9063,219.2344 Q1290.4063,219.2344 1289.0859,217.5859 Q1287.7656,215.9375 1287.7656,212.8125 Q1287.7656,209.6875 1289.0859,208.0313 Q1290.4063,206.375 1292.9063,206.375 Q1293.6094,206.375 1294.2578,206.5313 Q1294.9063,206.6875 1295.4688,206.9844 L1295.4688,209.7031 Q1294.8438,209.125 1294.25,208.8516 Q1293.6563,208.5781 1293.0313,208.5781 Q1291.6875,208.5781 1291,209.6484 Q1290.3125,210.7188 1290.3125,212.8125 Q1290.3125,214.9063 1291,215.9766 Q1291.6875,217.0469 1293.0313,217.0469 Q1293.6563,217.0469 1294.25,216.7734 Q1294.8438,216.5 1295.4688,215.9219 L1295.4688,218.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="75" x="1306.5" y="217.1543">nsISupports</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1278.5" x2="1383.5" y1="229" y2="229"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1278.5" x2="1383.5" y1="237" y2="237"/><!--link GMN31 to tokenizerTreeBuilderPair--><path d="M765.9015,820.8091 C778.3323,799.4612 806.7456,757.0754 844.5,740.5 C909.1036,712.137 1412.4182,718.6342 1479.5,740.5 C1520.9185,754.0006 1560.0715,786.6064 1583.7957,809.3772 " fill="none" id="GMN31-tokenizerTreeBuilderPair" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><!--link nsHTMLDocument to nsHtml5Parser--><path d="M1010.8601,588.1297 C1007.3448,603.9484 1003.526,621.1328 1000.25,635.8748 " fill="none" id="nsHTMLDocument-nsHtml5Parser" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1013.723,575.2467,1008.5167,580.2361,1011.1198,586.9609,1016.3261,581.9716,1013.723,575.2467" style="stroke: #A80036; stroke-width: 1.0;"/><!--link nsHtml5Parser to nsHtml5StreamParser--><path d="M1077.1035,716.0887 C1110.3378,732.9155 1149.0974,752.5398 1185.3074,770.8733 " fill="none" id="nsHtml5Parser-nsHtml5StreamParser" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1065.1242,710.0235,1068.6703,716.3024,1075.8302,715.4441,1072.284,709.1651,1065.1242,710.0235" style="stroke: #A80036; stroke-width: 1.0;"/><!--link nsHtml5Parser to nsHtml5StreamListener--><path d="M852.0798,713.9915 C800.8303,730.1959 742.7377,749.9719 691,771 C667.8931,780.3915 643.1448,792.1608 621.6892,802.9461 " fill="none" id="nsHtml5Parser-nsHtml5StreamListener" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="864.6098,710.0574,857.6871,708.0385,853.1609,713.6521,860.0836,715.6711,864.6098,710.0574" style="stroke: #A80036; stroke-width: 1.0;"/><!--link nsHtml5Parser to tokenizerTreeBuilderPair--><path d="M1159.9514,699.5814 C1282.0803,720.0409 1436.2219,748.5255 1497,771 C1523.1635,780.6747 1550.4399,796.1321 1571.2859,809.2537 " fill="none" id="nsHtml5Parser-tokenizerTreeBuilderPair" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1147.1111,697.44,1152.3713,702.3725,1158.9476,699.414,1153.6874,694.4815,1147.1111,697.44" style="stroke: #A80036; stroke-width: 1.0;"/><!--link nsHtml5StreamParser to tokenizerTreeBuilderPair--><path d="M1492.792,833.5 C1500.1569,833.5 1507.5218,833.5 1514.8867,833.5 " fill="none" id="nsHtml5StreamParser-tokenizerTreeBuilderPair" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1479.5352,833.5,1485.5352,837.5,1491.5352,833.5,1485.5352,829.5,1479.5352,833.5" style="stroke: #A80036; stroke-width: 1.0;"/><!--link nsHtml5StreamParser to nsHtml5TreeBuilder--><path d="M1309,909.4672 C1309,924.9531 1309,941.3067 1309,956.977 " fill="none" id="nsHtml5StreamParser-nsHtml5TreeBuilder" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1309,896.1207,1305,902.1207,1309,908.1207,1313,902.1207,1309,896.1207" style="stroke: #A80036; stroke-width: 1.0;"/><!--link nsHtml5StreamParser to nsHtml5Tokenizer--><path d="M1125.7402,894.8182 C1123.8202,895.2251 1121.9064,895.6193 1120,896 C764.6687,966.9678 655.805,858.8581 307,957 C280.7234,964.3934 253.7239,976.3341 229.6034,988.8224 " fill="none" id="nsHtml5StreamParser-nsHtml5Tokenizer" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1138.4897,891.9573,1131.7594,889.3682,1126.7809,894.5849,1133.5112,897.174,1138.4897,891.9573" style="stroke: #A80036; stroke-width: 1.0;"/><!--link nsHtml5Tokenizer to nsHtml5TreeBuilder--><path d="M223.2894,981.7032 C251.6594,963.6056 285.191,945.8948 318.6667,936.6667 C389.5415,917.1287 907.6429,925.6636 980.3333,936.6667 C1011.637,941.4051 1044.0663,948.5463 1075.8133,956.8922 " fill="none" id="nsHtml5Tokenizer-nsHtml5TreeBuilder" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="212.2767,988.9117,219.4875,988.9724,222.317,982.3396,215.1062,982.2789,212.2767,988.9117" style="stroke: #A80036; stroke-width: 1.0;"/><!--link nsHtml5TreeBuilder to nsHtml5Tokenizer--><path d="M1105.3457,952.5928 C1061.0501,937.5471 1013.8925,924.2046 968.6667,916.3333 C898.7912,904.1719 398.1921,895.7015 330.3333,916.3333 C283.3053,930.6318 237.3743,961.5408 203.3762,988.6894 " fill="none" id="nsHtml5TreeBuilder-nsHtml5Tokenizer" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1117.7594,956.8785,1113.3932,951.1394,1106.4164,952.9624,1110.7825,958.7015,1117.7594,956.8785" style="stroke: #A80036; stroke-width: 1.0;"/><!--link nsHtml5TreeBuilder to nsHtml5OplessBuilder--><path d="M1620.7645,1038.5 C1725.8403,1038.5 1834.6457,1038.5 1906.8783,1038.5 " fill="none" id="nsHtml5TreeBuilder-nsHtml5OplessBuilder" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1607.639,1038.5,1613.639,1042.5,1619.639,1038.5,1613.639,1034.5,1607.639,1038.5" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="57" x="1728.75" y="1031.5669">mBuilder</text><!--link nsHtml5TreeBuilder to nsHtml5TreeOperation--><path d="M1137.0243,1126.1415 C1063.4302,1163.6461 979.168,1206.5874 911.9895,1240.8226 " fill="none" id="nsHtml5TreeBuilder-nsHtml5TreeOperation" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1148.7398,1120.1711,1141.5777,1119.3316,1138.0481,1125.6198,1145.2102,1126.4593,1148.7398,1120.1711" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="1082" y="1185.0669">mOpQueue</text><!--link nsHtml5TreeBuilder to nsHtml5StackNode--><path d="M1286.9686,1133.3018 C1285.6194,1139.1076 1284.326,1144.6731 1283.1307,1149.8165 " fill="none" id="nsHtml5TreeBuilder-nsHtml5StackNode" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1289.995,1120.2792,1284.7406,1125.218,1287.2785,1131.9677,1292.5329,1127.0289,1289.995,1120.2792" style="stroke: #A80036; stroke-width: 1.0;"/><!--link nsHtml5StackNode to nsIContentHandle--><path d="M1269.8566,1224.1202 C1266.5339,1264.3736 1267.7916,1324.0804 1296,1366 C1316.0849,1395.8475 1350.2081,1416.0645 1381.614,1429.2655 " fill="none" id="nsHtml5StackNode-nsIContentHandle" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1271.1563,1211.0116,1266.5837,1216.5876,1269.9721,1222.953,1274.5447,1217.377,1271.1563,1211.0116" style="stroke: #A80036; stroke-width: 1.0;"/><!--link nsHtml5TreeOperation to nsIContent--><path d="M1017.9607,1237.7321 C1109.0994,1214.738 1215.4466,1191.8433 1313.5,1180.5 C1505.5525,1158.2824 1577.1642,1090.9354 1748.5,1180.5 C1788.2569,1201.2826 1813.2559,1249.9049 1825.3343,1279.4123 " fill="none" id="nsHtml5TreeOperation-nsIContent" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1005.204,1240.9761,1012.0048,1243.374,1016.8338,1238.0186,1010.0331,1235.6207,1005.204,1240.9761" style="stroke: #A80036; stroke-width: 1.0;"/><!--link nsContentSink to nsHtml5DocumentBuilder--><path d="M1987.0236,114.7716 C1987.9833,162.374 1989.3954,232.4127 1990.2531,274.9557 " fill="none" id="nsContentSink-nsHtml5DocumentBuilder" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1980.0228,114.7955,1986.6181,94.6584,1994.0199,114.5132,1980.0228,114.7955" style="stroke: #A80036; stroke-width: 1.0;"/><!--link nsHtml5DocumentBuilder to nsHtml5OplessBuilder--><path d="M1991,369.1517 C1991,399.2978 1991,436.9019 1991,470.5 C1991,470.5 1991,470.5 1991,833.5 C1991,898.8082 1991,975.8195 1991,1014.2012 " fill="none" id="nsHtml5DocumentBuilder-nsHtml5OplessBuilder" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1984.0001,369.1493,1991,349.1493,1998.0001,369.1493,1984.0001,369.1493" style="stroke: #A80036; stroke-width: 1.0;"/><!--link nsContentSink to Document--><path d="M1906.2818,99.381 C1886.2641,107.163 1864.6078,114.664 1844,120 C1590.5564,185.6245 1514.3024,134.7863 1260,197 C1254.1969,198.4197 1248.1972,200.1752 1242.289,202.0859 " fill="none" id="nsContentSink-Document" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1918.5099,94.5161,1911.4563,93.0174,1907.3599,98.952,1914.4135,100.4507,1918.5099,94.5161" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="80" x="1688" y="163.0669">mDocument</text><!--link nsDocument to nsHTMLDocument--><path d="M1072.1253,457.4862 C1063.2544,471.7352 1053.6722,487.1265 1045.2854,500.5978 " fill="none" id="nsDocument-nsHTMLDocument" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1066.3252,453.5579,1082.838,440.279,1078.2102,460.9571,1066.3252,453.5579" style="stroke: #A80036; stroke-width: 1.0;"/><!--link nsIHTMLDocument to nsHTMLDocument--><path d="M1253.6949,441.3351 C1210.3941,459.4005 1155.9895,482.0985 1110.782,500.9594 " fill="none" id="nsIHTMLDocument-nsHTMLDocument" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1251.2756,434.7597,1272.4289,433.5191,1256.6662,447.6803,1251.2756,434.7597" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Document to nsDocument--><path d="M1173.2169,263.5828 C1156.1142,298.6247 1132.281,347.4568 1116.9946,378.7774 " fill="none" id="Document-nsDocument" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1167.0979,260.1604,1182.161,245.2572,1179.6794,266.301,1167.0979,260.1604" style="stroke: #A80036; stroke-width: 1.0;"/><!--link nsINode to Document--><path d="M1198.1083,140.3752 C1197.0685,160.7815 1196.0189,181.3795 1195.2409,196.6477 " fill="none" id="nsINode-Document" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1191.1256,139.855,1199.1344,120.2372,1205.1075,140.5675,1191.1256,139.855" style="stroke: #A80036; stroke-width: 1.0;"/><!--link nsINode to nsIContent--><path d="M1408.7413,77.6615 C1587.3704,95.3331 1817,134.8117 1817,221 C1817,221 1817,221 1817,1038.5 C1817,1127.4759 1826.6624,1232.9121 1831.4181,1279.4179 " fill="none" id="nsINode-nsIContent" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1407.8513,84.6085,1388.6071,75.7394,1409.1818,70.6718,1407.8513,84.6085" style="stroke: #A80036; stroke-width: 1.0;"/><!--link nsINode to nsINode--><path d="M1401.7972,57.6507 C1415.2995,59.1146 1423.5,61.231 1423.5,64 C1423.5,67.5801 1409.7914,70.0694 1388.6396,71.4678 " fill="none" id="nsINode-nsINode" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1388.6396,56.5322,1394.2792,61.0261,1400.5965,57.5488,1394.9569,53.0549,1388.6396,56.5322" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="323" x="1429.5" y="61.0669">mFirstChild, mNextSibling, mPreviousOrLastSibling</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="196" x="1495" y="76.1997">(実際の型はnsIContentへの参照)</text><!--link nsINode to nsINode--><path d="M1401.8252,47.8212 C1563.6291,43.4913 1758.5,48.8842 1758.5,64 C1758.5,79.5251 1552.9315,84.7937 1388.7569,79.8056 " fill="none" id="nsINode-nsINode" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1388.7569,48.1944,1394.8687,52.0215,1400.752,47.8518,1394.6403,44.0247,1388.7569,48.1944" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="55" x="1764.5" y="68.5669">mParent</text><!--link nsISupports to nsIHTMLDocument--><path d="M1330.7648,265.3404 C1330.5659,302.8295 1330.2885,355.1249 1330.1282,385.3359 " fill="none" id="nsISupports-nsIHTMLDocument" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1323.7652,265.2197,1330.8713,245.2572,1337.765,265.2941,1323.7652,265.2197" style="stroke: #A80036; stroke-width: 1.0;"/><!--link nsHtml5Available to nsHtml5StreamParser--><path d="M1116.3358,833.5 C1123.6204,833.5 1130.905,833.5 1138.1895,833.5 " fill="none" id="nsHtml5Available-nsHtml5StreamParser" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1103.2236,833.5,1109.2236,837.5,1115.2236,833.5,1109.2236,829.5,1103.2236,833.5" style="stroke: #A80036; stroke-width: 1.0;"/><!--link nsHtml5StreamListener to nsHtml5StreamParser--><path d="M609.4051,794.5966 C636.3019,774.1588 672.1492,751.1866 708.5,740.5 C792.5008,715.8049 1016.8969,722.1131 1102.5,740.5 C1132.8691,747.0231 1164.1598,758.3766 1192.9112,770.958 " fill="none" id="nsHtml5StreamListener-nsHtml5StreamParser" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="598.8196,802.8612,606.0105,802.3217,608.2782,795.4765,601.0873,796.016,598.8196,802.8612" style="stroke: #A80036; stroke-width: 1.0;"/><!--link nsHtml5Parser to nsHtml5TreeOpExecutor--><path d="M1160.434,673 C1191.4395,673 1223.2913,673 1252.7034,673 " fill="none" id="nsHtml5Parser-nsHtml5TreeOpExecutor" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1147.2072,673,1153.2072,677,1159.2072,673,1153.2072,669,1147.2072,673" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="69" x="1165.5" y="666.0669">mExecutor</text><!--link nsHtml5TreeOpExecutor to nsHtml5Parser--><path d="M1239.3598,675.7537 C1232.0225,675.8498 1224.756,675.9333 1217.6667,676 C1194.8443,676.2148 1170.7243,676.1766 1147.0787,675.9893 " fill="none" id="nsHtml5TreeOpExecutor-nsHtml5Parser" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1252.6201,675.5679,1246.5646,671.6524,1240.6213,675.7362,1246.6768,679.6516,1252.6201,675.5679" style="stroke: #A80036; stroke-width: 1.0;"/><!--link nsHtml5TreeOpExecutor to nsHtml5StreamParser--><path d="M1356.0103,722.5419 C1349.5623,737.7611 1342.3791,754.7155 1335.6071,770.6994 " fill="none" id="nsHtml5TreeOpExecutor-nsHtml5StreamParser" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1361.2285,710.2253,1355.2047,714.1894,1356.5471,721.2745,1362.5708,717.3104,1361.2285,710.2253" style="stroke: #A80036; stroke-width: 1.0;"/><!--link nsIContent to nsIContentHandle--><path d="M1798.8924,1341.6232 C1788.9866,1350.6603 1777.6981,1359.5388 1766,1366 C1689.951,1408.004 1591.8359,1430.2857 1526.1214,1441.3404 " fill="none" id="nsIContent-nsIContentHandle" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1793.9982,1336.6184,1813.1805,1327.6162,1803.7989,1346.6158,1793.9982,1336.6184" style="stroke: #A80036; stroke-width: 1.0;"/><!--link nsIContent to HTMLSharedElement--><path d="M1834,1347.6327 C1834,1373.6475 1834,1405.5584 1834,1426.9836 " fill="none" id="nsIContent-HTMLSharedElement" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1827.0001,1347.5267,1834,1327.5267,1841.0001,1347.5267,1827.0001,1347.5267" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml

class nsHTMLDocument {
  nsHtml5Parser : mParser(@Document.h)
}
class nsHtml5Parser {
  RefPtr<nsHtml5StreamListener> : mStreamListener
  RefPtr<nsHtml5TreeOpExecutor> : mExecutor
}
note top: document.write()から得られるデータを扱う

class nsHtml5StreamParser {
  nsCOMPtr<nsISerialEventTarget> : mEventTarget
  mozilla::UniquePtr<mozilla::Decoder> : mUnicodeDecoder
  nsHtml5OwningUTF16Buffer* : mFirstBuffer
  nsHtml5OwningUTF16Buffer* : mLastBuffer
  nsAutoPtr<nsHtml5TreeBuilder> : mTreeBuilder
  nsAutoPtr<nsHtml5Tokenizer> : mTokenizer
}
note top: networkから得られるデータを扱う

class nsHtml5Tokenizer {
  nsHtml5TreeBuilder* : tokenHandler
  //== nsHtml5StreamParser#mTreeBuilder
  tokenizer作成時にtokenHandlerは引数で渡される
  - ElementName : tagname
}

class nsHtml5TreeBuilder {
  mBuilder : nsHtml5OplessBuilder
  # nsHtml5Tokenizer* : tokenizer 
  treeBuilder生成時はtokenzerはnull\nその後startTokenizationするときに引数としてtokenizerを渡している
  nsStreamParserがtokenizerをtreeBuilderを作る
  tokenizerを作る(arg: treeBuilder)
  OnRequest時にstreamParser#mTokenize->startでtokenizerが tokenHandler->startTokenization(this)する
  - autoJArray<nsHtml5StackNode*, int32_t> : stack
  - nsTArray<nsHtml5TreeOperation> : mOpQueue
}

class nsHtml5OplessBuilder {

}

class nsHtml5DocumentBuilder {

  void SetDocumentMode(nsHtml5DocumentMode m)
  Document* GetDocument() { return mDocument; }
}

class nsContentSink {
  # mDocument : nsCOMPtr<Document>
}
note right : parserから文字列を受け取って溜めてDOMを作る場所

class nsHTMLDocument {
  void SetCompatibilityMode
}

interface Document {

}
note left : Document interface.\n This is implemented by all document objects in Gecko(元nsIDocument).

class nsDocument {
  nsIPresShell* mPresShell;
}

interface nsINode {
   nsresult AppendChildTo(nsIContent* aKid, bool aNotify)
   # nsINode* MOZ_OWNING_REF mParent
   # nsCOMPtr<nsIContent> mFirstChild
   # nsCOMPtr<nsIContent> mNextSibling
   # nsIContent* MOZ_NON_OWNING_REF mPreviousOrLastSibling
} 
note left : An internal interface that abstracts some DOMNode-related parts that both\n nsIContent and Document share.  An instance of this interface has a list\n of nsIContent children and provides access to them.

class nsHtml5Available {
    nsHtml5StreamParserPtr : mStreamParser
}

class nsHtml5StreamListener {
    nsHtml5StreamParser* : mDelegate
}

class tokenizerTreeBuilderPair {
}
note left: parsing data

class nsHtml5TreeOpExecutor{
  RefPtr<nsParserBase> : mParser
  nsHtml5StreamParser* : mStreamParser
}

class nsHtml5StackNode {
  - nsIContentHandle* : node
}

class nsIContentHandle {

}

class nsIContent {
}
note left : A node of content in a document's content model. This interface \n is supported by all content objects.

class HTMLSharedElement {
}

class nsHtml5TreeOperation {
  - union{nsIContent** node} : mOne
  - union{} : mTwo
  - eHtml5TreeOperation : mOpCode
  void Init()
  // args: (eHtml5TreeOperation aOpCode, char16_t* aBuffer, int32_t aLength, nsIContentHandle* aParent)
  // 呼び出し例: treeOp->Init(eTreeOpAppendText, bufferCopy.release(), aLength, deepTreeSurrogateParent ? deepTreeSurrogateParent : aParent);
}

note top: portable_parser_coreのtree_operationという出力をactions_performed_on_the_Gecko_DOMに変える

nsHTMLDocument *-d- nsHtml5Parser
nsHtml5Parser *-d- nsHtml5StreamParser
nsHtml5Parser *-d- nsHtml5StreamListener
nsHtml5Parser *- tokenizerTreeBuilderPair
nsHtml5StreamParser *- tokenizerTreeBuilderPair
nsHtml5StreamParser *-down- nsHtml5TreeBuilder 
nsHtml5StreamParser *-down- nsHtml5Tokenizer
nsHtml5Tokenizer *- nsHtml5TreeBuilder
nsHtml5TreeBuilder *- nsHtml5OplessBuilder : mBuilder
nsHtml5TreeBuilder *-down- nsHtml5TreeOperation : mOpQueue
nsHtml5TreeBuilder *- nsHtml5StackNode
nsHtml5TreeBuilder *- nsHtml5Tokenizer
nsHtml5StackNode *- nsIContentHandle
nsHtml5TreeOperation *- nsIContent
nsContentSink <|- - nsHtml5DocumentBuilder
nsHtml5DocumentBuilder <|- - nsHtml5OplessBuilder
nsContentSink *- - Document : mDocument
nsDocument <|- - nsHTMLDocument
nsIHTMLDocument <|- - nsHTMLDocument
Document <|- - nsDocument
nsINode <|- - Document
nsINode <|- - nsIContent 
nsINode *- nsINode : mFirstChild, mNextSibling, mPreviousOrLastSibling\n (実際の型はnsIContentへの参照)
nsINode *- nsINode : mParent
nsISupports <|- - nsIHTMLDocument

nsHtml5Available *- nsHtml5StreamParser
nsHtml5StreamListener *- nsHtml5StreamParser
nsHtml5Parser *- nsHtml5TreeOpExecutor : mExecutor
nsHtml5TreeOpExecutor *- nsHtml5Parser
nsHtml5TreeOpExecutor *- nsHtml5StreamParser
nsIContent <|- - nsIContentHandle
nsIContent <|- - HTMLSharedElement

@enduml

PlantUML version 1.2018.12(Sun Oct 21 19:15:15 JST 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_191-8u191-b12-2ubuntu0.18.04.1-b12
Operating System: Linux
OS Version: 4.15.0-45-generic
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>